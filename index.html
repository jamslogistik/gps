<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realtime GPS Tracking</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            text-align: center;
        }
        
        #status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
        }
        
        .loading {
            background-color: #e0f0ff;
            color: #004085;
        }
        
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <h1>Realtime GPS Tracker</h1>
    <div id="status">Menginisialisasi...</div>

    <!-- Tambahkan SDK Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>

    <script>
        // Konfigurasi Firebase Anda
        const firebaseConfig = {
            apiKey: "AIzaSyAm7UYqJxVQE-66N7iw5fF0bwLnV9WHrV8",
            authDomain: "gps-tracking-46fc6.firebaseapp.com",
            projectId: "gps-tracking-46fc6",
            storageBucket: "gps-tracking-46fc6.firebasestorage.app",
            messagingSenderId: "623400729396",
            appId: "1:623400729396:web:2e225550227e1fa1148361"
        };

        // Inisialisasi Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Referensi database
        const locationsRef = database.ref('locations');

        // Fungsi update status
        function updateStatus(message, className) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = className;
        }

        // Ambil lokasi pengguna
        function getLocation() {
            updateStatus("Mengambil lokasi...", "loading");
            
            if (navigator.geolocation) {
                const watchId = navigator.geolocation.watchPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        const timestamp = new Date().toISOString();

                        // Kirim data ke Firebase
                        locationsRef.push({
                            latitude: lat,
                            longitude: lng,
                            timestamp: timestamp
                        }).then(() => {
                            updateStatus(`Lokasi terkirim: ${lat}, ${lng}`, "success");
                        }).catch((error) => {
                            updateStatus(`Error mengirim data: ${error}`, "error");
                        });
                    },
                    (error) => {
                        updateStatus(`Error geolokasi: ${error.message}`, "error");
                    },
                    {
                        enableHighAccuracy: true,
                        maximumAge: 30000,
                        timeout: 27000
                    }
                );
            } else {
                updateStatus("Geolokasi tidak didukung oleh browser ini", "error");
            }
        }

        // Mulai saat halaman dimuat
        window.onload = getLocation;
    </script>
</body>
</html>
